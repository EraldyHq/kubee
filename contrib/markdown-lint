#!/bin/bash

# Markdown Link Check Script
# This script loops through all subdirectories and runs markdown-link-check
# while avoiding 'test' and 'build' directories

set -e  # Exit on any error

# Loop through all subdirectories
for childPath in docs/*; do
  if [ ! -d "$childPath" ]; then
      continue
  fi
  if [[ "$childPath" =~ (bin|man) ]]; then
      continue
  fi
  echo "$childPath"
  markdown-link-check \
            --config contrib/markdown-lint-config.json \
            --quiet \
            "$childPath"
done

echo "README main"
markdown-link-check \
            --config contrib/markdown-lint-config.json \
            --quiet \
            "README.md"

echo "README charts"
markdown-link-check \
            --config contrib/markdown-lint-config.json \
            --quiet \
            charts/**/README.md
