

[//]: # (README.md generated by gotmpl. DO NOT EDIT.)

![Type: application](https://img.shields.io/badge/Type-application-informational?style=flat-square) ![Version: 0.0.1](https://img.shields.io/badge/Version-0.0.1-informational?style=flat-square) ![AppVersion: v5.16.0](https://img.shields.io/badge/AppVersion-v5.16.0-informational?style=flat-square)

# Kubee Kubernetes Monitoring Chart

This [jsonnet kubee chart](https://github.com/EraldyHq/kubee/blob/main/docs/site/jsonnet-chart.md) installs monitoring
for:
* the core Kubernetes components
* and for the hosts/node (cpu/memory/storage)

The core systems Kubernetes components are:
* Api Server
* Controller Manager
* Core Dns
* Kubelet
* Kube Proxy
* Scheduler

## Features

### Metrics, Prometheus Rules and Dashboard

The following monitoring elements are installed:
* [Kube-prometheus Prometheus scrape config](https://github.com/prometheus-operator/kube-prometheus)
* [Kubernetes Rules and Grafana dashboards](https://monitoring.mixins.dev/kubernetes/)
* [Node Rules and Grafana dashboards](https://monitoring.mixins.dev/node-exporter/#dashboards)

The dashboards are using metrics from:
* the `Kubernetes System components`
* the `Kube-State-Metrics` exporter
* the [node exporter](https://github.com/prometheus/node_exporter)

The Kubernetes components metrics reference list is available [here](https://kubernetes.io/docs/reference/instrumentation/metrics/)
* `apiserver_xxx`: Api server metrics
* `kubeexx`: Kubelet metrics:

### Kubee Charts Features

  These [kubee charts](https://github.com/EraldyHq/kubee/blob/main/docs/site/kubee-helmet-chart.md) add their features when `enabled`.

* [grafana](https://github.com/EraldyHq/kubee/blob/main/charts/grafana/README.md) creates [dashboards](https://grafana.com/grafana/dashboards/)
* [prometheus](https://github.com/EraldyHq/kubee/blob/main/charts/prometheus/README.md) creates [metrics scraping jobs](https://prometheus.io/docs/concepts/jobs_instances/) and [alert rules](https://prometheus.io/docs/prometheus/latest/configuration/alerting_rules/)

## Installation

```bash
kubee helmet --cluster cluster-name play kubernetes-monitoring
```

## Values

| Key | Type | Default | Description |
|-----|------|---------|-------------|
| api_server.enabled | bool | `true` | Enable Api Server monitoring |
| api_server.scrape_interval | string | `"60s"` | Scrape Interval (Normal default was 30s and 5s for sli) |
| api_server.scrape_metrics_optimization | bool | `true` | Metrics Optimization. For memory and cost optimization, low level metrics are dropped For api server, Buckets metrics are high cardinality metrics that are not used in alerting but in debugging and consume a lot of memory |
| core_dns.enabled | bool | `true` | Enable Core DNS monitoring |
| core_dns.scrape_interval | string | `"30s"` | Scrape Interval (normal default was 15s) |
| enabled | bool | `false` | Boolean to indicate that this chart is or will be installed in the cluster |
| kube_state_metrics.enabled | bool | `true` | Enable [Kube State Metrics Exporter](https://github.com/kubernetes/kube-state-metrics). It exports apps/functional state metrics. |
| kube_state_metrics.memory | string | `"50Mi"` | The max memory of the exporter |
| kube_state_metrics.scrape_interval | string | `"60s"` | The scrape interval |
| kube_state_metrics.version | string | `"2.14.0"` | [Kube State Metrics Version](https://github.com/kubernetes/kube-state-metrics/releases) without the `v` |
| kubelet.enabled | bool | `true` | Enable kubelet monitoring |
| kubelet.scrape_interval | string | `"45s"` | Scrape interval. Why 45s. Headlamp uses a CPU rate functon over 1 minutes If the scrape interval is above 1m, there is no data returned |
| kubelet.scrape_metrics_optimization | bool | `true` | Metrics Optimization. For memory and cost optimization, low level metrics are dropped For api server, Buckets metrics are high cardinality metrics that are not used in alerting but in debugging and consume a lot of memory |
| namespace | string | `"monitoring"` | The installation namespace |
| node_exporter.enabled | bool | `true` | Enable [Node Exporter](https://github.com/prometheus/node_exporter) It will gather server resources metrics |
| node_exporter.memory | string | `"50Mi"` | Max memory of the exporter (On Kube Prometheus, it was set to 180Mi) |
| node_exporter.scrape_interval | string | `"45s"` | Scrape Interval (Default was 15s) |
| node_exporter.scrape_metrics_optimization | bool | `true` | Memory and cost optimization. Low levels metrics are dropped |
| node_exporter.version | string | `"1.8.2"` | [Node Exporter Version](https://github.com/prometheus/node_exporter/releases) without the `v` |

## Dev/Contrib

If you want to contribute to the development of this chart. Check [Dev/Contrib page](contrib/contrib.md)

