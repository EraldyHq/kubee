

[//]: # (README.md generated by gotmpl. DO NOT EDIT.)

![Type: application](https://img.shields.io/badge/Type-application-informational?style=flat-square) ![Version: 0.0.1](https://img.shields.io/badge/Version-0.0.1-informational?style=flat-square) ![AppVersion: 0.28.0](https://img.shields.io/badge/AppVersion-0.28.0-informational?style=flat-square)

# Kubee AlertManager Chart

This is a [jsonnet chart](https://github.com/EraldyHq/kubee/blob/main/docs/site/jsonnet-chart.md) that installs [Prometheus Alert manager](https://prometheus.io/docs/alerting/latest/alertmanager/)

`Prometheus Alert manager` receives alerts from Prometheus
and manage them, ie:
* silence,
* group,
* aggregate
* route them to:
    * email
    * or an external incident management platform such as OpsGenie.

## Chart Features

### Alert Notifications Channels

The following alert notifications channels are implemented:

* Email
* OpsGenie (if api_key is not null)

### WatchDog

The `Watchdog` is a cron monitoring system that monitors the livelihood of the prometheus monitoring system itself.

Prometheus AlertManager should ping it at interval:
* via email
* and http requests
otherwise it's considered dead.

The cron monitoring system should alert you if it does not receive any ping.

This monitoring system is also known as the [DeadMansSnitch](https://en.wikipedia.org/wiki/Dead_man%27s_switch)

It's implemented with the [watchdog alert](https://runbooks.prometheus-operator.dev/runbooks/general/watchdog).

### Kubee Charts Features

  These [kubee charts](https://github.com/EraldyHq/kubee/blob/main/docs/site/kubee-helmet-chart.md) add their features when `enabled`.

* [cert-manager](https://github.com/EraldyHq/kubee/blob/main/charts/cert-manager/README.md) adds [server certificates](https://cert-manager.io/docs/usage/certificate/) to the servers
* [external-secrets](https://github.com/EraldyHq/kubee/blob/main/charts/external-secrets/README.md) defines secret as [external secrets](https://external-secrets.io/latest/introduction/getting-started/#create-your-first-externalsecret) for GitOps integration (if chosen)
* [grafana](https://github.com/EraldyHq/kubee/blob/main/charts/grafana/README.md) creates [dashboards](https://grafana.com/grafana/dashboards/)
* [prometheus](https://github.com/EraldyHq/kubee/blob/main/charts/prometheus/README.md) creates [metrics scraping jobs](https://prometheus.io/docs/concepts/jobs_instances/) and [alert rules](https://prometheus.io/docs/prometheus/latest/configuration/alerting_rules/)
* [traefik](https://github.com/EraldyHq/kubee/blob/main/charts/traefik/README.md) creates an [ingress](https://kubernetes.io/docs/concepts/services-networking/ingress/) if hostnames are defined

## Installation

```bash
kubee helmet --cluster cluster-name play alertmanager
```

## Values

| Key | Type | Default | Description |
|-----|------|---------|-------------|
| enabled | bool | `false` | Boolean to indicate that this chart is or will be installed in the cluster |
| hostname | string | `""` | The public hostname |
| namespace | string | `"monitoring"` | The installation namespace (create an ingress if not empty) |
| opsgenie.api_key | string | `""` | Opsgenie Api Key to send alert. If the api key is not empty, critical and warning alerts are sent to opsgenie |
| resources.memory | string | `"50Mi"` | Memory |
| secret.kind | string | `"Secret"` | The kind of Secret manifest created |
| version | string | `"0.28.0"` | The [alert manager version](https://github.com/prometheus/alertmanager/releases) |
| watchdog | object | `{"email":{"repeat_interval":"12h","to":""},"webhook":{"repeat_interval":"10m","url":""}}` | `Watchdog`: the receiver of the [watchdog alert](https://runbooks.prometheus-operator.dev/runbooks/general/watchdog) Example of cron monitoring system: https://healthchecks.io/ |

## Contrib / Dev

See [contrib](contrib/contrib.md)

